//版本
Nmap 7.70 ( https://nmap.org ) 

//用法：nmap [扫描类型] [选项] 目标
Usage: nmap [Scan Type(s)] [Options] {target specification}

//目标规格
TARGET SPECIFICATION:
  //可以传递主机名、IP 地址、网络等。					
  Can pass hostnames, IP addresses, networks, etc.
  
  //例如：scanme.nmap.org...
  Ex: scanme.nmap.org, microsoft.com/24, 192.168.0.1; 10.0.0-255.1-254
	
	//从主机/网络 列表输入 
  -iL <inputfilename>: Input from list of hosts/networks
  
  //选择随机目标 
  -iR <num hosts>: Choose random targetss
  
  //排除主机/网络
  --exclude <host1[,host2][,host3],...>: Exclude hosts/networks
  
  //从文件中排除列表
  --excludefile <exclude_file>: Exclude list from file

//主机发现
HOST DISCOVERY:
	//列表扫描 - 简单地列出要扫描的目标
  -sL: List Scan - simply list targets to scan
  
  //Ping 扫描 - 禁用端口扫描
  -sn: Ping Scan - disable port scan
  
	//将所有主机视为在线——跳过主机发现
  -Pn: Treat all hosts as online -- skip host discovery
  
  //TCP SYN/ACK、UDP 或 SCTP 发现到给定端口
  -PS/PA/PU/PY[portlist]: TCP SYN/ACK, UDP or SCTP discovery to given ports
  
  //ICMP 回显、时间戳和网络掩码请求发现探测
  -PE/PP/PM: ICMP echo, timestamp, and netmask request discovery probes
  
  //IP协议Ping
  -PO[protocol list]: IP Protocol Ping
  
  //从不进行 DNS 解析/始终解析 [默认：有时]
  -n/-R: Never do DNS resolution/Always resolve [default: sometimes]
  
  //指定自定义 DNS 服务器
  --dns-servers <serv1[,serv2],...>: Specify custom DNS servers
  
  //使用操作系统的 DNS 解析
  --system-dns: Use OS's DNS resolver
  
  //跟踪每个主机的跃点路径
  --traceroute: Trace hop path to each host

//扫描技术
SCAN TECHNIQUES:
	//TCP SYN/Connect()/ACK/Window/Maimon 扫描
  -sS/sT/sA/sW/sM: TCP SYN/Connect()/ACK/Window/Maimon scans
  
  //UDP扫描
  -sU: UDP Scan
  
  //TCP Null、FIN 和 Xmas 扫描
  -sN/sF/sX: TCP Null, FIN, and Xmas scans
  
  //自定义 TCP 扫描标志
  --scanflags <flags>: Customize TCP scan flags
  
  //空闲扫描
  -sI <zombie host[:probeport]>: Idle scan
  
  //SCTP INIT/COOKIE-ECHO 扫描
  -sY/sZ: SCTP INIT/COOKIE-ECHO scans
  
  //IP协议扫描
  -sO: IP protocol scan
  
  //FTP 退回扫描
  -b <FTP relay host>: FTP bounce scan

//端口规格和扫描顺序
PORT SPECIFICATION AND SCAN ORDER:
	//只扫描特定端口
  -p <port ranges>: Only scan specified ports
		//例如：
    Ex: -p22; -p1-65535; -p U:53,111,137,T:21-25,80,139,8080,S:9

	//从扫描中排除指定的端口
  --exclude-ports <port ranges>: Exclude the specified ports from scanning
  
  //快速模式 - 扫描比默认扫描更少的端口
  -F: Fast mode - Scan fewer ports than the default scan
  
  //连续扫描端口 - 不要随机化
  -r: Scan ports consecutively - don't randomize
  
  //扫描 <number> 个最常见的端口
  --top-ports <number>: Scan <number> most common ports
  
  //扫描端口比 <ratio> 更常见
  --port-ratio <ratio>: Scan ports more common than <ratio>

//服务/版本检测： 
SERVICE/VERSION DETECTION:
	//探测开放端口以确定服务/版本信息
  -sV: Probe open ports to determine service/version info
  
  //设置从 0（光）到 9（尝试所有探头）
  --version-intensity <level>: Set from 0 (light) to 9 (try all probes)
  
  //限制为最可能的探针（强度 2）
  --version-light: Limit to most likely probes (intensity 2)
  
  //尝试每一个探头（强度 9）
  --version-all: Try every single probe (intensity 9)
  
  //显示详细的版本扫描活动（用于调试）
  --version-trace: Show detailed version scan activity (for debugging)

//脚本扫描 
SCRIPT SCAN:
	//相当于 --script=default
  -sC: equivalent to --script=default
  
  //<Lua scripts> 是一个逗号分隔的目录、脚本文件或脚本类别列表
  --script=<Lua scripts>: <Lua scripts> is a comma separated list of
           directories, script-files or script-categories
           
	//为脚本提供参数
  --script-args=<n1=v1,[n2=v2,...]>: provide arguments to scripts
  
  //在文件中提供 NSE 脚本参数
  --script-args-file=filename: provide NSE script args in a file
  
  //显示所有发送和接收的数据
  --script-trace: Show all data sent and received
  
  //更新脚本数据库。
  --script-updatedb: Update the script database.
  
  //显示有关脚本的帮助。
  --script-help=<Lua scripts>: Show help about scripts.  
					//<Lua scripts> 是一个以逗号分隔的脚本文件或脚本类别列表。
           <Lua scripts> is a comma-separated list of script-files or
           script-categories.

//操作系统检测
OS DETECTION:
	//启用操作系统检测
  -O: Enable OS detection
  
  //将操作系统检测限制为有希望的目标
  --osscan-limit: Limit OS detection to promising targets
  
  //更积极地猜测操作系统
  --osscan-guess: Guess OS more aggressively

//时间和性能
TIMING AND PERFORMANCE:
	//需要 <time> 的选项以秒为单位，或附加 'ms'（毫秒），'s'（秒）、'm'（分钟）或 'h'（小时）到值（例如 30m）。
	Options which take <time> are in seconds, or append 'ms' (milliseconds),
	's' (seconds), 'm' (minutes), or 'h' (hours) to the value (e.g. 30m).
  
	//设置计时模板（越高越快）
	-T<0-5>: Set timing template (higher is faster)
  
  //并行主机扫描组大小
  --min-hostgroup/max-hostgroup <size>: Parallel host scan group sizes
  
  //探针并行化
  --min-parallelism/max-parallelism <numprobes>: Probe parallelization
  
  //指定探测往返时间
  --min-rtt-timeout/max-rtt-timeout/initial-rtt-timeout <time>: Specifies
      probe round trip time.
      
	//端口扫描探测重传次数上限
  --max-retries <tries>: Caps number of port scan probe retransmissions.
  
  //超时后放弃目标
  --host-timeout <time>: Give up on target after this long
  
  //调整探头之间的延迟
  --scan-delay/--max-scan-delay <time>: Adjust delay between probes
  
  //每秒发送数据包的速度不低于 <number>
  --min-rate <number>: Send packets no slower than <number> per second
  
  //每秒发送数据包的速度不超过 <number>
  --max-rate <number>: Send packets no faster than <number> per second

//防火墙/IDS 逃避和欺骗
FIREWALL/IDS EVASION AND SPOOFING:
	
	//分段数据包（可选带给定 MTU）
  -f; --mtu <val>: fragment packets (optionally w/given MTU)
  
  //用诱饵掩盖扫描
  -D <decoy1,decoy2[,ME],...>: Cloak a scan with decoys
  
  //欺骗源地址
  -S <IP_Address>: Spoof source address
  
  //使用指定接口
  -e <iface>: Use specified interface
  
  //使用给定的端口号
  -g/--source-port <portnum>: Use given port number
  
  //通过 HTTP/SOCKS4 代理中继连接
  --proxies <url1,[url2],...>: Relay connections through HTTP/SOCKS4 proxies
  
  //将自定义负载附加到发送的数据包
  --data <hex string>: Append a custom payload to sent packets
  
  //将自定义 ASCII 字符串附加到发送的数据包
  --data-string <string>: Append a custom ASCII string to sent packets
  
  //将随机数据附加到发送的数据包
  --data-length <num>: Append random data to sent packets
  
  //使用指定的 ip 选项发送数据包
  --ip-options <options>: Send packets with specified ip options
  
  //设置 IP 生存时间字段
  --ttl <val>: Set IP time-to-live field
  
  //欺骗您的 MAC 地址
  --spoof-mac <mac address/prefix/vendor name>: Spoof your MAC address
  
  //使用伪造的 TCP/UDP/SCTP 校验和发送数据包
  --badsum: Send packets with a bogus TCP/UDP/SCTP checksum

//输出
OUTPUT:

	//分别以 normal、XML、s|<rIpt kIddi3 和 Grepable 格式输出扫描到给定的文件名。
  -oN/-oX/-oS/-oG <file>: Output scan in normal, XML, s|<rIpt kIddi3,
     and Grepable format, respectively, to the given filename.
     
	//一次输出三种主要格式
  -oA <basename>: Output in the three major formats at once
  
  //增加详细级别（使用 -vv 或更多以获得更大的效果）
  -v: Increase verbosity level (use -vv or more for greater effect)
  
  //提高调试级别（使用 -dd 或更多以获得更大的效果）
  -d: Increase debugging level (use -dd or more for greater effect)
  
  //显示端口处于特定状态的原因
  --reason: Display the reason a port is in a particular state
  
  //只显示开放（或可能开放）的端口
  --open: Only show open (or possibly open) ports
  
  //显示所有发送和接收的数据包
  --packet-trace: Show all packets sent and received
  
  //打印主机接口和路由（用于调试）
  --iflist: Print host interfaces and routes (for debugging)
  
  //附加到而不是破坏指定的输出文件
  --append-output: Append to rather than clobber specified output files
  
  //恢复中止的扫描
  --resume <filename>: Resume an aborted scan
  
  //将 XML 输出转换为 HTML 的 XSL 样式表
  --stylesheet <path/URL>: XSL stylesheet to transform XML output to HTML
  
  //来自 Nmap.Org 的参考样式表以获得更可移植的 XML
  --webxml: Reference stylesheet from Nmap.Org for more portable XML
  
  //防止 XSL 样式表与/XML 输出关联
  --no-stylesheet: Prevent associating of XSL stylesheet w/XML output

//杂项 
MISC:
	//启用 ipv6扫描
  -6: Enable IPv6 scanning
  
  //启用 操作系统检测、版本检测、脚本扫描和跟踪路由
  -A: Enable OS detection, version detection, script scanning, and traceroute
  
  //指定自定义 Nmap 数据文件位置
  --datadir <dirname>: Specify custom Nmap data file location
  
  //使用原始以太网帧或 IP 数据包发送
  --send-eth/--send-ip: Send using raw ethernet frames or IP packets
  
  //假设用户拥有完全特权
  --privileged: Assume that the user is fully privileged
  
  //假设用户没有原始套接字权限
  --unprivileged: Assume the user lacks raw socket privileges
  
  //版本信息、帮助
  -V: Print version number
  -h: Print this help summary page.
 
//例子
EXAMPLES:
  nmap -v -A scanme.nmap.org
  nmap -v -sn 192.168.0.0/16 10.0.0.0/8
  nmap -v -iR 10000 -Pn -p 80
  
//有关更多选项和示例，请参阅手册页
SEE THE MAN PAGE (https://nmap.org/book/man.html) FOR MORE OPTIONS AND EXAMPLES
